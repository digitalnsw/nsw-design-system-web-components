!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lit"),require("@digitalnsw/simple-fields/lib/simple-fields-field.js"),require("@digitalnsw/simple-icon/lib/simple-icon-lite.js"),require("@digitalnsw/simple-icon/lib/simple-icons.js"),require("@digitalnsw/simple-tooltip/simple-tooltip.js")):"function"==typeof define&&define.amd?define(["exports","lit","@digitalnsw/simple-fields/lib/simple-fields-field.js","@digitalnsw/simple-icon/lib/simple-icon-lite.js","@digitalnsw/simple-icon/lib/simple-icons.js","@digitalnsw/simple-tooltip/simple-tooltip.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).SimpleSearch={},e.lit)}(this,(function(e,t){"use strict";function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}function f(e,t,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function b(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var d,m,v,y=function(e){a(r,e);var n=h(r);function r(){return i(this,r),n.apply(this,arguments)}return l(r,[{key:"enableSearch",value:function(e){var t=this;e.addEventListener("simple-search",(function(n){return t._searchContent(e)})),e.addEventListener("goto-result",(function(e){return t.focus(e.detail)}))}},{key:"_searchContent",value:function(e){var t=this.innerHTML;this.innerHTML=e.findMatches(t)}},{key:"focus",value:function(e){var t=this.querySelector('[match-number="'+e+'"]');null!=t&&t.focus()}},{key:"render",value:function(){return t.html(d||(d=b([" <slot></slot> "])))}}],[{key:"tag",get:function(){return"simple-search-content"}}]),r}(t.LitElement);customElements.define(y.tag,y);var g,x,_=function(e){a(o,e);var n=h(o);function o(){return i(this,o),n.apply(this,arguments)}return l(o,[{key:"render",value:function(){return t.html(m||(m=b([" <slot></slot> "])))}}],[{key:"tag",get:function(){return"simple-search-match"}},{key:"properties",get:function(){return r(r({},f(c(o),"properties",this)),{},{matchNumber:{type:Number,reflect:!0,attribute:"match-number"}})}},{key:"styles",get:function(){return[t.css(v||(v=b(["\n        :host {\n          margin-right: 4px;\n          font-family: var(--simple-search-match-font-family, unset);\n          color: var(--simple-search-match-text-color, #000);\n          background-color: var(--simple-search-match-bg-color, #f0f0f0);\n          border: var(--simple-search-match-border, 1px solid);\n          border-color: var(--simple-search-match-border-color, #ddd);\n          padding: var(--simple-search-match-padding, 0.16px 0px 0.16px 4px);\n          border-radius: var(--simple-search-match-border-radius, 0.16px);\n          font-weight: var(--simple-search-match-font-weight, bold);\n        }\n      "])))]}}]),o}(t.LitElement);customElements.define(_.tag,_);var w=function(e){a(o,e);var n=h(o);function o(){var e;return i(this,o),(e=n.call(this)).alwaysFloatLabel=!1,e.caseSensitive=null,e.controls=null,e.nextButtonIcon="arrow-forward",e.nextButtonLabel="next result",e.noLabelFloat=!1,e.prevButtonIcon="arrow-back",e.prevButtonLabel="previous result",e.resultCount=0,e.resultPointer=0,e.searchInputIcon="search",e.searchInputLabel="search",e.searchTerms=[],e.target=null,e.selector=null,e.__hideNext=!0,e.__hidePrev=!0,e}return l(o,[{key:"render",value:function(){return t.html(g||(g=b(['\n\n<simple-fields-field\n    id="input"\n    label="','"\n    ?inline="','"\n    @value-changed="','"\n  >\n    <simple-icon-lite icon="','" slot="','"></simple-icon-lite>\n  </simple-fields-field>\n  <div id="xofy" ?shrink-hide="','">\n    ','\n  </div>\n  <div id="searchnav" ?shrink-hide="','">\n    <button\n      id="prev"\n      aria-label="','"\n      role="button"\n      controls="','"\n      tabindex="0"\n      ?disabled="','"\n      @click="','"\n    >\n      <simple-icon-lite icon="','"></simple-icon-lite>\n    </button>\n    <simple-tooltip for="prev">','</simple-tooltip>\n    <button\n      id="next"\n      aria-label="','"\n      role="button"\n      controls="','"\n      tabindex="0"\n      ?disabled="','"\n      @click="','"\n    >\n      <simple-icon-lite icon="','"></simple-icon-lite>\n    </button>\n    <simple-tooltip for="next">',"</simple-tooltip>\n  </div>"])),this.searchInputLabel,this.inline||this.noLabelFloat,this._handleChange,this.searchInputIcon,this.inline?"label-prefix":"prefix",this._hasNoSearch(this.searchTerms),this._getResultsSpan(this.resultPointer,this.resultCount),this._hasNoSearch(this.searchTerms),this.prevButtonLabel,this.controls,this.__hidePrev,this._navigateResults,this.prevButtonIcon,this.prevButtonLabel,this.nextButtonLabel,this.controls,this.__hideNext,this._navigateResults,this.nextButtonIcon,this.nextButtonLabel)}},{key:"updated",value:function(e){var t=this;e.forEach((function(e,n){"resultPointer"!==n&&"resultCount"!==n||t._getNavDisabled(t.resultPointer,t.resultCount)}))}},{key:"_handleChange",value:function(e){var t=this,n=this.selector?" ".concat(this.selector):"",r=this.controls?this.getRootNode().querySelectorAll("#".concat(this.controls).concat(n)):null;this._getSearchText(),this.resultCount=0,this.resultPointer=0,r.forEach((function(e){t._searchSelection(e)})),this.dispatchEvent(new CustomEvent("simple-search",{detail:{search:this,content:e}}))}},{key:"_searchSelection",value:function(e){e&&e.innerHTML&&(e.innerHTML=this.findMatches(e.innerHTML))}},{key:"_hasNoSearch",value:function(e){return e.length<1}},{key:"_getResultsSpan",value:function(e,t){return t>0&&e>0?e+"/"+t:t>0?t:"0"}},{key:"_navigateResults",value:function(e){var t="next"===e.currentTarget.id?1:-1;this.resultPointer+t>0&&this.resultPointer+t<=this.resultCount&&(this.resultPointer+=t,this.dispatchEvent(new CustomEvent("goto-result",{detail:this.resultPointer})))}},{key:"_getNavDisabled",value:function(e,t){this.__hidePrev=this._isNavButtonDisabled(e,t,-1),this.__hideNext=this._isNavButtonDisabled(e,t)}},{key:"_isNavButtonDisabled",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return!t||0===t||e+n<=0||e+n>t}},{key:"_getSearchText",value:function(){var e=this.shadowRoot.querySelector("#input").value,t=new Array;if(null!=e){t=e.split(/[\"\']/gm);for(var n=0;n<t.length;n++)t[n]=t[n].trim(),""===t[n]&&t.splice(n,1)}this.searchTerms=t.slice(0)}},{key:"findMatches",value:function(e){var t=this;return this.resultPointer=0,e=e.replace(/<\/?simple-search-match[^>]*>/g,""),this.searchTerms.forEach((function(n){var r=t.caseSensitive?"gm":"gim",i=new RegExp("\\b("+n+")\\b",r);e=e.replace(i,(function(e){return t.resultCount++,'<simple-search-match tabindex="0" match-number="'.concat(t.resultCount,'">').concat(e,"</simple-search-match>")}))})),e}}],[{key:"styles",get:function(){return[t.css(x||(x=b(["\n:host {\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n  width: 100%;\n  background-color: var(--simple-search-input-background-color, transparent);\n}\n\n#input {\n  flex-grow: 2;\n  margin-right: 4px;\n  padding: var(--simple-search-padding, unset);\n  margin: var(--simple-search-margin, unset);\n  color: var(--simple-search-input-text-color, #000);\n  --simple-fields-color: var(--simple-search-input-text-color, #000);\n  --simple-fields-container-color: var(--simple-search-input-placeholder-color, #222);\n  --simple-fields-background-color: var(--simple-fields-input-background-color, transparent);\n  --simple-icon-color: var(--simple-search-input-placeholder-color, #222);\n}\n\n#xofy {\n  margin: 8px;\n}\n\nbutton {\n  margin: 8px 0 8px;\n  border-style: solid;\n  border-width: 1px;\n  border-color: var(--simple-search-button-border-color, #ccc);\n  color: var(--simple-search-button-color, #111);\n  background-color: var(--simple-search-button-bg-color, #eee);\n  border-color: var(--simple-search-button-border-color, #ccc);\n}\n\nbutton:not([disabled]):focus,\nbutton:not([disabled]):hover {\n  cursor: pointer;\n  color: var(--simple-search-button-hover-color, #000);\n  background-color: var(--simple-search-button-hover-bg-color, #fff);\n  border-color: var(--simple-search-button-hover-border-color, #ddd);\n}\n\nbutton[disabled] {\n  cursor: not-allowed;\n  color: var(--simple-search-button-disabled-color, #999);\n  background-color: var(--simple-search-button-disabled-bg-color, #eee);\n  border-color: var(--simple-search-button-disabled-border-color, #ccc);\n}\n\nbutton:not([controls]) {\n  display: none;\n}\n\n#searchnav {\n  flex: 1 0 auto;\n}\n\n#searchnav button {\n  display: inline;\n  flex: 1 0 auto;\n}\n\n*[shrink-hide] {\n  display: none;\n}\n      "])))]}},{key:"properties",get:function(){return r(r({},f(c(o),"properties",this)),{},{alwaysFloatLabel:{attribute:"always-float-label",type:Boolean},caseSensitive:{attribute:"case-sensitive",type:Boolean},controls:{attribute:"controls",type:String},inline:{attribute:"inline",type:Boolean},nextButtonIcon:{attribute:"next-button-icon",type:String},nextButtonLabel:{attribute:"next-button-label",type:String},noLabelFloat:{attribute:"no-label-float",type:Boolean},prevButtonIcon:{attribute:"prev-button-icon",type:String},prevButtonLabel:{attribute:"prev-button-label",type:String},resultCount:{attribute:"result-count",type:Number},resultPointer:{attribute:"result-pointer",type:Number},selector:{attribute:"selector",type:String},searchInputIcon:{attribute:"search-input-icon",type:String},searchInputLabel:{attribute:"search-input-label",type:String},searchTerms:{attribute:"search-terms",type:Array},target:{type:Object},__hideNext:{type:Boolean},__hidePrev:{type:Boolean}})}},{key:"tag",get:function(){return"simple-search"}}]),o}(t.LitElement);customElements.define(w.tag,w),e.SimpleSearch=w,Object.defineProperty(e,"__esModule",{value:!0})}));
